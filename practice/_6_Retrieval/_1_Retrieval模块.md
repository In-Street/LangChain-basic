常用于构建 企业/私人的知识库
Retrieval 包括：数据的获取、切分、向量化、向量存储、向量检索
    Document loaders
    Text splitters
    Embedding models
    Vectorstores
    Retrievers

## Retrieval 模块的设计意义

1. LLM的幻觉问题
    在面向专业领域知识提问时，无法给出可靠准确的回答，甚至胡言乱语，称为幻觉。
    可通过 Prompt 减少幻觉，业界共识的一个方案：
        首先，为大模型提供上下文信息，让其输出变得更稳定，
        其次，利用RAG，将检索出的「文档和提示词」给大模型，生成更可靠的答案。


2. RAG优缺点
     优点：
            相对于提示词工程，RAG有 「更丰富的上下文和数据样本」，用户可以不需要提供过多的背景描述，就能生成符合预期的答案
            相对于模型微调，模型知识有冻结时间，如只截止到2025的数据，RAG可以提升问答内容的「时效性」和「可靠性」
            一定程度上保护业务数据的隐私
     缺点：
            每次问答都涉及外部系统数据检索，因此RAG的 响应时延 较高
            引用的外部知识数据会「消耗大量的token」资源

## Retrieval 流程
1. 环节1:  Source（数据源）RAG 架构中所外挂的知识库
        原始数据源类型：文本、图片、视频、代码、文档
        形式： .csv   .json   .pdf    某个网站的实时数据等

2. 环节2: Load（加载）
        文档加载器 Document Loaders ，负责将不同数据的非结构化文本，加载到内存，成为 Document 文档对象。如： TextLoader('xxx.txt'')
        文档对象包括：文档内容、元数据；
        文档加载器支持「延迟加载」模式，来缓解处理大文件时的内存压力；

3. 环节3: Transform（转换）
        文档转换器，负责对加载的文档进行转换和处理。提供的工具包括：

            文本拆分器（Text Splitters）:  将长文本拆分成 语义上相关的小块，以适应语言模型的上下文窗口限制。文档切块后才能 向量化 并存入数据库中
                    1. LangChain 提供丰富的文档拆分器，包括：普通文本、Markdown、JSON、HTML、代码
                    2. 分块策略：比如针对文本类，可按字符、段落、token、语义 切片
            
            冗余过滤器（Redundancy Filters）:   识别并过滤重复的文档

            元数据提取器（Metadata Extractors）:  从文档中提取标题、语调等结构化元数据，如：创建时间、文本大小、文本修改人

            多语言转换器（Muti-lingual Transformers）:  实现文档的机器翻译

            对话转换器（Conversational Transformers）:  将非结构化对话转换为问答格式的文档

4. 环节4: Embed（嵌入）
        文档嵌入模型，负责将上一步的切块 转换为向量表示，使文本可用于向量空间中的各种运算
        原理： 
            通过特定的算法（如 Word2Vec）将语义信息编码为固定纬度的向量，算法层
        关键特性：相似的词在向量空间中距离相近
        Embed 为LangChain中的问答、检索、推荐等功能提供重要的支持：

                1. 语义匹配：通过计算两个文本向量的余弦相似度，判断它们在语义上的相似度，实现语义匹配
                            
                2. 文本检索： 通过计算不同文本之间的向量相似度，实现语义检索，找到向量空间中最相似的文本

                3.信息推荐： 根据用户的历史记录或兴趣，嵌入生成用户向量，计算不同信息的向量与用户向量的相似度，推荐相似的信息
                4.知识挖掘 ：可以通过聚类、降维等手段分析文本向量的分布，发现文本之间的潜在关联，挖掘知识
                5.自然语言处理 ：将词语、句子等表示为稠密向量，为神经网络等下游任务提供输入
                
5. 环节5: Store（存储）
        向量数据库
        
6. 环节6: Retrieve（检索）
        响应非结构化查询的借口，返回符合查询要求的文档
        LangChain 提供的检索器： 向量检索器、文档检索器、网站研究检索器
        通过配置不同的检索器，LangChain 可灵活地平衡：检索的精度、召回率、效率。检索的结果为后续的问答生成提供信息支持，来产生更精准和完整的回答